<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>한양에서 김서방 찾기</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="./assets/css/normalize.css">
</head>
<style>
    @font-face {
        font-family: 'UhBeeDongKyung';  /*어비동경체*/
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_five@.2.0/UhBeeDongKyung.woff') format('woff');
        font-weight: normal;
        font-style: normal;
    }

    /* body{opacity:.03;} */

    .cf:after{content: ''; display: block; clear: both;}

    header{position: fixed; top: 0; left: 0; right: 0; background: lightpink; display: flex; align-items: center; justify-content: space-between; z-index: 2;}
    header{padding: 5px; text-align: right;}
    header button{outline: 0; border: 0; border-radius: 3px; width: 60px; padding: 5px; box-sizing: border-box; color: #fff; font-weight: 900;}
    .init{background: red;}
    .start{background: blue;}


    .board{padding-top: 40px; width: 2500px;}
    .board > div{
        float: left; width: 50px; height: 50px; box-sizing: border-box;
        line-height: 50px; text-align: center; box-shadow: inset 0 0 5px rgba(0, 0, 0, .5);
    }
    .board > div.on{background: #000; color: #fff;}

    .person{position: relative; display: flex; flex-direction: column; align-items: center; width: 50px; height: 50px; padding-top: 5px;}
    .person:after{
        content: ''; display: block; width: 100%; height: 100%;  position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        z-index: 2; box-sizing: border-box;
    }
    .person > div{box-sizing: border-box;}
    .person .head{width: 20px; height: 20px; border-radius: 50%; background: #ffd8a7; z-index: 1;}
    .person .body{width: 30px; height: 30px; border-radius: 30px 30px 0 0; background: red; top: -5px; position: relative;}
    .person .hat{
        width: 20px; height: 10px; border-radius: 20px 20px 0 0; background: #db934c;
        position: absolute; top: 3px; left: 50%; margin-left: -10px; z-index: 1;
    }
    .person .hat:after{
        content: ''; display: block; position: absolute; bottom: 0; left: -5px; width: 30px; height: 2px; background: #db934c; border-radius: 50%;
    }
    .person .glass{position: absolute; top: 15px; left: 50%; width: 20px; margin-left: -10px; z-index: 1; display: none;}
    .person.mr-kim .glass{display: block;}
    .person  .glass:before, .person  .glass:after{
        content: ''; display: block; position: absolute; top: 0; width: 9px; height: 5px; background: #000; border-radius: 0 0 10px 10px;
        background: linear-gradient(135deg, rgba(0, 0, 0, .5) 50%, black 0);
        border: 1px solid rgba(0,0,0,.5); box-sizing: border-box;
    }
    .person  .glass:before{left: 1px;}
    .person  .glass:after{right: 1px;}




</style>
<body>
    <header>
        <div id="guide">시작버튼을 눌러주세요.</div>
        <div>
            <button class="init" onclick="findd.init();">초기화</button>
            <button class="start" onclick="findd.gameStart();">시작</button>
        </div>
    </header>
    <div id="board" class="board cf">
    </div>
    <div class="person mr-kim">
        <div class="head"></div>
        <div class="body"></div>
        <div class="hat"></div>
        <div class="glass"></div>
    </div>



    <script>

        const qs = function(t){return document.querySelector(t);}
        const qsa = function(t){return document.querySelectorAll(t);}
        const board = qs('#board');
        const guide = qs('#guide');



        const findd = new FindText();

        function FindText(){
            const t = this;
            t.xCnt = 50;
            t.yCnt = 50;
            t.start = false;
            t.end = false;

            t.kimIdx = 0;

            t.gameStart = function(){
                if(t.start !== false) return;

                t.initValue();

                t.start = new Date().getTime();
                guide.innerText = '김서방을 찾아주세요.';

                t.kimIdx = getRandomNum(0, ((t.xCnt * t.yCnt) - 1));

                for(let i = 0; i < t.xCnt; i++){
                    for(let j = 0; j < t.yCnt; j++){
                        const person = document.createElement('div');
                        person.classList.add('person');
                        const head = document.createElement('div');
                        head.classList.add('head');
                        const body = document.createElement('div');
                        body.classList.add('body');
                        const hat = document.createElement('div');
                        hat.classList.add('hat');
                        const glass = document.createElement('div');
                        glass.classList.add('glass');

                        person.appendChild(head);
                        person.appendChild(body);
                        person.appendChild(hat);
                        person.appendChild(glass);

                        person.dataset.idx = (i * t.xCnt) + j;

                        board.append(person);
                    }
                }

                board.querySelector('div[data-idx="' + t.kimIdx + '"]').classList.add('mr-kim');
            }

            t.answer = function(idx){
                if(t.kimIdx == idx){
                    t.end = new Date().getTime();
                    alert(((t.end - t.start) / 1000) + '초만에 찾으셨습니다.\n' + (t.kimIdx + 1) + '번째에 있었네요...');
                    t.start = false;
                }
            }

            t.init = function(){
                if(confirm('초기화 할까요?')) location.reload();
            }

            t.initValue = function(){
                t.xCnt = 50;
                t.yCnt = 50;
                t.start = false;
                t.kimIdx = 0;

                guide.innerText = '시작버튼을 눌러주세요.';
            }
        }

        function getRandomNum(mn, mx){return Math.floor(Math.random() * (mx - mn + 1)) + mn;};

        board.addEventListener('click', function(e){
            findd.answer(e.target.dataset.idx);
        });
    </script>
</body>
</html>